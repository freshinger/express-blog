{% extends "../_adminLayout.html" %}

{% block content %}
  <h1>Admin Dashboard</h1>

  <details name="create">
    <summary>New Post</summary>
    {% include './_newPostForm.html' %}
  </details>

  <hr />

  <details name="list" open>
    <summary>Post List</summary>
    {% include './_postList.html' %}
  </details>
{% endblock %}

{% block scripts %}
  {% if posts and posts.length > 0 %}
    {% for post in posts %}
      <dialog id="modal-{{ post.id }}">
        <article>
          <header>
            <button
              aria-label="Close"
              rel="prev"
              data-target="modal-{{ post.id }}"
              onclick="toggleModal(event)"
            ></button>
            <h3>edit post {{ post.slug }}</h3>
          </header>
          <form method="post" action="/admin">
            <input type="hidden" name="id" value="{{ post.id }}" />
            <input type="hidden" name="action" value="edit" />
            <label for="author-{{ post.id }}">Author</label>
            <input
              type="text"
              id="author-{{ post.id }}"
              name="author"
              placeholder="Text"
              value="{{ post.author }}"
            />
            <label for="title-{{ post.id }}">Title</label>
            <input
              type="text"
              id="title-{{ post.id }}"
              name="title"
              placeholder="Text"
              value="{{ post.title }}"
            />
            <label for="teaser-{{ post.id }}">Teaser</label>
            <input
              type="text"
              id="teaser-{{ post.id }}"
              name="teaser"
              placeholder="teaser"
              value="{{ post.teaser }}"
            />
            {# TODO: possibility to change or upload image  #}
            <label for="content-{{ post.id }}">Content</label>
            <textarea
              class="editable"
              id="content-{{ post.id }}"
              name="content"
              placeholder="content"
            >
{{ post.content | unescape | safe }}</textarea
            >
            <input type="submit" value="save" />
          </form>
          <footer>
            <button
              role="button"
              class="secondary"
              data-target="modal-{{ post.id }}"
              onclick="toggleModal(event)"
            >
              Cancel
            </button>
          </footer>
        </article>
      </dialog>
    {% endfor %}
  {% endif %}
  <script src="/js/modal.js"></script>
{% endblock %}
